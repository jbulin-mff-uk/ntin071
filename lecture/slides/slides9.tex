\documentclass[handout]{beamer}

\input{header.tex}


\title{Lecture 9 -- Closure properties of context-free languages, Dyck languages}


\begin{document}


\frame{\titlepage}


\begin{frame}{Recap of Lecture 8}
	
    \begin{itemize}
        \item Pushdown automata accept exactly context-free languages (constructions: CFG to PDA and PDA to CFG)
        \item A deterministic pushdown automaton (DPDA)
        \item DPDA recognize a proper subclass of context-free languages,\\ accepts by empty stack iff prefix-free and accepts by final state\\
        (Deterministic PDA + acceptance by empty stack does not even cover regular languages!)
        \item Deterministic PDA have unambiguous grammars
        \item The landscape of languages
        \item Converting between representations of context-free languages
        \item Undecidable problems about context-free languages (preview)
	\end{itemize}

\end{frame}


\section*{2.12 Closure properties of context-free languages}


\begin{frame}{Closed under union, concatenation, iteration, reverse}

    \begin{theorem}
        If $L,L'\subseteq\Sigma^*$ are context-free, then so are $L\cup L'$, $L.L'$, $L^*$, $L^+$, $L^R$.
    \end{theorem}
    \textbf{Proof:} Let $G,G'$ be CFG generating $L,L'$ such that $V\cap V'=\emptyset$. Take a new start symbol $S_{new}\notin V\cup V'$.
        
    \begin{itemize}
        \item \alert{union} $L\cup L'$: add the rule $S_{new}\rightarrow S_1\mid S_2$
        \item \alert{concatenation} $L.L'$: add $S_{new}\rightarrow S_1S_2$
        \item \alert{iteration} $L^*$: add $S_{new}\rightarrow SS_{new}\mid\epsilon$
        \item \alert{positive iteration} $L^+$: add $S_{new}\rightarrow SS_{new}\mid S$           
        \item \alert{reverse} $L^R$: reverse the bodies of all production rules \\(i.e., $A\to\beta$ becomes $A\to\beta^R$)\hfill\qedsymbol
    \end{itemize}

\end{frame}


\begin{frame}{Not closed under intesection}

    \begin{example}
        $L=\{0^n1^n2^n \mid n\geq 1\}=\{0^n1^n2^i \mid n,i\geq 1\}\cap \{0^i1^n2^n \mid n,i\geq 1\}$
    \end{example}

    $L$ is not context-free, even though both operands of the intersection are context-free:
 
    $L_1=\{0^n1^n2^i\mid n,i\geq 1\}$ generated by $G=(\{S,A,B\},\{0,1\},\mathcal P,S)$ with production rules 
    $$
    \mathcal P=\{S\rightarrow AB, A\rightarrow 0A1\mid\epsilon, B\rightarrow 2B\mid\epsilon \}
    $$
        
    $L_2=\{0^n1^n2^i \mid n,i\geq 1\}$ generated similarly using production rules 
    $$
    \mathcal P=\{S\rightarrow AB, A\rightarrow 0A\mid\epsilon, B\rightarrow 1B2\mid\epsilon \}
    $$

\end{frame}


\begin{frame}{Simulating two PDAs in parallel}

    Regular languages are closed under intersection, because we can simulate two DFAs in parallel. Why not PDAs?

    \begin{itemize}
        \item the FA units can be merged (same as for DFAs)
        \item reading input can be merged (one automaton can wait)
        \item but two stacks cannot be simulated on one stack!
    \end{itemize}
        
    In fact, `PDAs with two stacks' are equivalent to \alert{Turing machines}, can recognize any \alert{recursively enumerable} language $L\in{\mathcal L}_0$.

    \medskip
    \vdots
    \medskip

    But what if one of the PDAs does not really use its stack?

\end{frame}


\begin{frame}{Intersection of a context-free and a regular language}

    \begin{theorem}
        Let $L$ be a context-free language and $R$ a regular language. Then $L\cap R$ is context free. Moreover, if $L$ is deterministic, so is $L\cap R$.
    \end{theorem}

    \textbf{Proof:} Let $L=L(P)$ for a PDA $P=(Q_1,\Sigma,\Gamma,\delta_1,q_1,Z_0,F_1)$ and $R=L(A)$ for a DFA $A=(Q_2,\Sigma,\delta_2,q_2,F_2)$. Construct a PDA 
    $$
    M=(Q_1\times Q_2,\Sigma,\Gamma,\delta, (q_1,q_2),Z_0,F_1\times F_2)
    $$ 
    where we have a transition $\delta((q_1,q_2),a,X)\ni((r_1,r_2),\gamma)$ iff either
    \begin{enumerate}[(i)]
        \item $a\neq\epsilon$ and $(r_1,\gamma)\in \delta_1(q_1,a,X)$ and $r_2=\delta_2(q_2,a)$, or
        \item $a=\epsilon$ and $(r_1,\gamma)\in \delta_1(q_1,\epsilon,X)$ and $r_2=q_2$
    \end{enumerate}
    In (i) both automata read input, in (ii) $P$ works on its stack while $A$ waits. Clearly, $L(M)=L(P)\cap L(A)$ ($P$ and $R$ run in parallel).\hfill\qedsymbol       

\end{frame}


\begin{frame}{An application: proving non-context-freeness}

    \begin{example}
        $L=\{0^i1^j2^k3^\ell\mid i=0 \text{ or }j=k=\ell\}$ is not context-free.
    \end{example}
    
    \vspace{-6pt}
    By contradiction, assume $L$ is context-free.

    \smallskip
    The language $L_1=\{01^j2^k3^\ell \mid i,j,k\geq 0\}$ is regular (e.g. a regular grammar $\{S\rightarrow 0B, B\rightarrow 1B\mid C, C\rightarrow 2C\mid D, D\rightarrow 3D\mid\epsilon\}$.

    \smallskip
    But $L\cap L_1=\{01^i2^i3^i\mid i\geq 0\}$ is not context-free, a contradiction with the previous theorem.
    \hfill\qedsymbol

    \vspace{3pt}
    In fact, $L$ is a \alert{context-sensitive} language:    
    
    {\small
    \begin{columns}

        \column{0.48\linewidth}

        $S\rightarrow \epsilon\mid 0\mid 0A\mid B_1\mid C_1\mid D_1$\\
        $A\rightarrow 0\mid 0A\mid P$, $P\rightarrow 1PCD \mid  1CD$\\
        $B_1\rightarrow 1\mid 1B_1\mid C_1$\\
        $C_1\rightarrow 2\mid 2C_1\mid D_1$\\
        $D_1\rightarrow 3\mid 3D_1$
        
        \column{0.32\linewidth}

        \alert{$DC\rightarrow CD$} rewrite
        as\\ 
        context-sensitive rules\\
         $DC\rightarrow XC$, $XC\rightarrow XY$,\\ 
         $XY\rightarrow CY$, $CY\rightarrow CD$\\
        \phantom{.}
        
        \column{0.13\linewidth}

        $1C\rightarrow 12$\\
        $2C\rightarrow 22$\\
        $2D\rightarrow 23$\\
        $3D\rightarrow 33$\\
        \phantom{.}        
        
    \end{columns}
    }

\end{frame}


\begin{frame}{Difference and complement}

    \begin{theorem}
        The class of the context-free languages is not closed under difference, nor complement.
    \end{theorem}

    \textbf{Proof:} $L_1\cap L_2=\overline{\overline{L_1}\cup\overline{L_2}}$, closure under complement would imply closure under intersection. For difference, use $\overline{L}=\Sigma^2-L$.\hfill\qedsymbol

    \textbf{NB:} PDA is non-deterministic, switching accepting/non-accepting states does not work.

    \medskip

    \begin{proposition}
        If $L$ is context-free and $R$ regular, then $L-R$ is context-free.
    \end{proposition}

    \textbf{Proof:} $L-R=L\cap\overline{R}$, and $\overline{R}$ is also regular.\hfill\qedsymbol 

\end{frame}


\section*{Substitution and homomorphism}


\begin{frame}{Recall the definitions}
   
    A (string) \alert{substitution} is a mapping $\sigma\colon \Sigma^*\rightarrow \mathcal P(Y^*)$ where
    \begin{itemize}
        \item $\Sigma$ and $Y$ are finite alphabets, $Y=\bigcup_{x\in \Sigma}Y_x$
        \item for each $x\in \Sigma$, $\sigma(x)$ is a language over $Y_x$
        \item $\sigma(\epsilon)=\{\epsilon\}$ and $\sigma(u.v)=\sigma(u).\sigma(v)$
    \end{itemize}
    For a language $L\subseteq \Sigma^*$, $\alert{\sigma(L)}=\bigcup_{w\in L}\sigma(w)\subseteq Y^*$. %A substitution is \alert{$\epsilon$-free} if no $\sigma(x)$ contains $\epsilon$.

    A (string) \alert{homomorphism} is defined similarly but each letter is mapped to a single word, $h\colon\Sigma^*\rightarrow Y^*$ where $h(x)\in Y_x^*$ for $x\in\Sigma$, $h(\epsilon)=\epsilon$ and $h(u.v)=h(u).h(v)$. Then \alert{$h(L)=\{h(w)\mid w\in L\}$}. %It is \alert{$\epsilon$-free} if $h(x)\neq\epsilon$ for all $x\in\Sigma$.

    The \alert{inverse homomorphism} applied to a language $L'\subseteq Y^*$: 
    $$
    h^{-1}(L')=\{w\in\Sigma^*\mid h(w)\in L'\}
    $$

\end{frame}


\begin{frame}{Example: substitution}
    
    \begin{example}
    Consider $G=(\{E\},\{a,+,(,)\},\{E\rightarrow E+E\mid (E)\mid a\},E)$. Let us have the following substitution:
    \begin{itemize}
        \item $\sigma(a)=L(G_a)$, where 
        \vspace{-3pt}
        $$
        G_a=(\{I\},\{a,b,0,1\},\{I\rightarrow I0\mid I1\mid Ia\mid Ib\mid a\mid b\},I)
        $$
        \vspace{-18pt}
        \item $\sigma(+)=\{-,*,:, \div, \mod\}$
        \item $\sigma(()=\{(\}$
        \item $\sigma())=\{)\}$
    \end{itemize}
    \end{example}
    Take $(a+a)+a\in L(G)$. Note that $(a+a)+a \notin \sigma(L(G))$, because $+\notin\sigma(+)$. But e.g. $(a001-bba)*b1 \in \sigma((a+a)+a)\subseteq\sigma(L(G))$

    \smallskip

    What if we modify the definition: $\sigma(\alert{(})=\{\alert{(},\alert{[}\}$, $\sigma(\alert{)})=\{\alert{)},\alert{]}\}$?

\end{frame}

  
\begin{frame}{Example: homomorphism}
        
    \begin{columns}

        \column{0.5\textwidth}
    
        \begin{example}
            $G=(\{E\},\{a,+,(,)\},$ $\{E\rightarrow E+E\mid (E)\mid a\},E)$        
            \begin{itemize}            
                \item $h(a)=\epsilon$
                \item $h(+)=\epsilon$
                \item $h(()=left$
                \item $h())=right$               
            \end{itemize}
        \end{example}
        \begin{itemize}
            \item $h((a+a)+a)=leftright $,
            \item $h^{-1}(leftright)\ni (a++)a$.
        \end{itemize}

        \vspace{1.75cm}
    
        \column{0.5\textwidth}

        \begin{example}
            $G=(\{E\},\{a,+,(,)\},$ $\{E\rightarrow a+E\mid (E)\mid a\},E)$
            \begin{itemize}
                \item $h_2(a)=a$
                \item $h_2(+)=+$
                \item $h(()=\epsilon$
                \item $h())=\epsilon$
            \end{itemize}
        \end{example}
        Are the following regular?
        \begin{enumerate}
            \item $L(G)$
            \item $h(L(G))$
            \item $h^{-1}(h(L(G)))$
            \item $h^{-1}(h(L(G)))=L(G)$
        \end{enumerate}        
        
    \end{columns}
            
\end{frame}


\begin{frame}{Closure under substitution and homomorphism}
   
    \begin{theorem}
        Let $L\subseteq\Sigma^*$ be a context-free language.
        \begin{enumerate}[(i)]
            \item If $\sigma$ is a substitution on $\Sigma$ such that $\sigma(a)$ is context-free for all $a\in \Sigma$, then $\sigma(L)$ is context-free.
            \item If $h$ is a homomorphism on $\Sigma$, then $h(L)$ is context-free.
        \end{enumerate}   
    \end{theorem}

    \textbf{Proof:} TODO
    
\end{frame}


\section*{2.13 Dyck languages}


\begin{frame}{Dyck languages}

    
\end{frame}


\begin{frame}{A characterization of context-free languages}


\end{frame}


\begin{frame}{The proof}

    

\end{frame}


\end{document}